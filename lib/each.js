// Generated by CoffeeScript 1.12.7

/*
Enumerate system root CAs synchronously
 */
var crypt;

crypt = require('./crypt32');

module.exports = function(cb) {
  var ctx, store;
  store = crypt.CertOpenSystemStoreA(null, 'ROOT');
  try {
    ctx = null;
    while (1) {
      ctx = crypt.CertEnumCertificatesInStore(store, ctx);
      if (ctx.isNull()) {
        return;
      }
      cb(ctx.deref().crt());
    }
  } finally {
    crypt.CertCloseStore(store, 0);
  }
};
